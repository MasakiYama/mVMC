CC	= mpicc

LIB = -fopenmp  -framework Accelerate -llapack -lblas -lm
OPTION = -D_mpi_use -D_lapack

OUT = vmc.out
SRC = vmcmain.c
PFAPACK = pfapack/libpfapack.a
SFMT = sfmt/SFMT.o
OBJS = vmcmain.o $(PFAPACK) $(SFMT)

.PHONY: all pfapack sfmt

all : $(OUT)

$(OUT) : vmcmain.o sfmt pfapack
	$(CC) -o $(OUT) $(OBJS) -O3 $(LIB) 

vmcmain.o : *.c *.h
	$(CC) -c $(SRC) $(OPTION) $(CFLAGS) 

pfapack :
	$(MAKE) -C pfapack -f Makefile_gnu
sfmt :
	$(MAKE) -C sfmt -f Makefile_gnu
